{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dhava/Downloads/ai-code-reviewer/app/api/review/route.js"],"sourcesContent":["// import { Groq } from \"groq-sdk\"\n\n// export async function POST(request) {\n//   try {\n//     const { code, language } = await request.json()\n\n//     if (!code || !code.trim()) {\n//       return Response.json({ error: \"Code is required\" }, { status: 400 })\n//     }\n\n//     const apiKey = process.env.GROQ_API_KEY\n//     if (!apiKey) {\n//       console.error(\"[v0] GROQ_API_KEY not found in environment\")\n//       return Response.json({ error: \"API key not configured\" }, { status: 500 })\n//     }\n\n//     const groq = new Groq({ apiKey })\n\n//     const prompt = `You are an expert code reviewer. Analyze the following ${language} code in detail and provide a comprehensive review.\n\n// CODE:\n// \\`\\`\\`${language}\n// ${code}\n// \\`\\`\\`\n\n// Analyze every statement, function, and logic flow. Be specific and actionable.\n\n// Provide your analysis in JSON format ONLY, with no additional text. Use exactly this structure:\n// {\n//   \"score\": <number 0-100>,\n//   \"summary\": \"<brief overall assessment>\",\n//   \"issues\": [\n//     {\n//       \"severity\": \"critical|high|medium|low\",\n//       \"title\": \"<issue title>\",\n//       \"description\": \"<detailed description>\",\n//       \"line\": \"<approximate line or area>\",\n//       \"suggestion\": \"<how to fix it>\"\n//     }\n//   ],\n//   \"suggestions\": [\n//     {\n//       \"category\": \"refactoring|naming|structure|clarity\",\n//       \"title\": \"<suggestion title>\",\n//       \"description\": \"<detailed suggestion>\",\n//       \"benefit\": \"<why this matters>\"\n//     }\n//   ],\n//   \"performance\": [\n//     {\n//       \"title\": \"<performance issue>\",\n//       \"description\": \"<detailed explanation>\",\n//       \"impact\": \"high|medium|low\",\n//       \"recommendation\": \"<how to optimize>\"\n//     }\n//   ],\n//   \"security\": [\n//     {\n//       \"title\": \"<security concern>\",\n//       \"description\": \"<detailed explanation>\",\n//       \"risk\": \"critical|high|medium|low\",\n//       \"mitigation\": \"<how to fix>\"\n//     }\n//   ],\n//   \"bestPractices\": [\n//     {\n//       \"title\": \"<best practice>\",\n//       \"description\": \"<explanation>\"\n//     }\n//   ]\n// }`\n\n//     console.log(\"[v0] Sending request to Groq API\")\n\n//     const message = await groq.chat.completions.create({\n//       model: \"llama-3.1-70b-versatile\",\n//       max_tokens: 4000,\n//       messages: [\n//         {07\n//           role: \"user\",\n//           content: prompt,\n//         },\n//       ],\n//     })\n\n//     console.log(\"[v0] Groq response received\")\n\n//     const responseText = message.choices[0]?.message?.content || \"\"\n\n//     if (!responseText) {\n//       console.error(\"[v0] Empty response from Groq\")\n//       return Response.json({ error: \"Empty response from AI\" }, { status: 500 })\n//     }\n\n//     // Parse JSON response from Groq\n//     const jsonMatch = responseText.match(/\\{[\\s\\S]*\\}/)\n//     if (!jsonMatch) {\n//       console.error(\"[v0] Failed to extract JSON from response:\", responseText.substring(0, 200))\n//       return Response.json({ error: \"Failed to parse analysis response\" }, { status: 500 })\n//     }\n\n//     const analysis = JSON.parse(jsonMatch[0])\n//     console.log(\"[v0] Analysis parsed successfully\")\n//     return Response.json(analysis)\n//   } catch (error) {\n//     console.error(\"[v0] Review API error:\", error.message)\n//     return Response.json({ error: error.message || \"Failed to analyze code\" }, { status: 500 })\n//   }\n// }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Groq } from \"groq-sdk\"\n\nexport async function POST(request) {\n  try {\n    const { code, language } = await request.json()\n\n    if (!code || !code.trim()) {\n      return Response.json({ error: \"Code is required\" }, { status: 400 })\n    }\n\n    const apiKey = process.env.GROQ_API_KEY\n    if (!apiKey) {\n      console.error(\"[v0] GROQ_API_KEY not found in environment\")\n      return Response.json({ error: \"API key not configured\" }, { status: 500 })\n    }\n\n    const groq = new Groq({ apiKey })\n\n    const prompt = `You are an expert code reviewer. Analyze the following ${language} code in detail and provide a comprehensive review.\n\nCODE:\n\\`\\`\\`${language}\n${code}\n\\`\\`\\`\n\nAnalyze every statement, function, and logic flow. Be specific and actionable.\n\nProvide your analysis in JSON format ONLY, with no additional text. Use exactly this structure:\n\n{\n  \"score\": <number 0-100>,\n  \"summary\": \"<overall assessment>\",\n  \"issues\": [\n    {\n      \"severity\": \"critical|high|medium|low\",\n      \"title\": \"<issue title>\",\n      \"description\": \"<detailed description>\",\n      \"line\": \"<line number or range>\",\n      \"suggestion\": \"<how to fix>\"\n    }\n  ],\n  \"suggestions\": [\n    {\n      \"category\": \"refactoring|naming|structure|clarity\",\n      \"title\": \"<suggestion title>\",\n      \"description\": \"<detailed description>\",\n      \"benefit\": \"<why this helps>\"\n    }\n  ],\n  \"performance\": [\n    {\n      \"title\": \"<performance issue>\",\n      \"description\": \"<detailed description>\",\n      \"impact\": \"high|medium|low\",\n      \"recommendation\": \"<how to improve>\"\n    }\n  ],\n  \"security\": [\n    {\n      \"title\": \"<security concern>\",\n      \"description\": \"<detailed description>\",\n      \"risk\": \"critical|high|medium|low\",\n      \"mitigation\": \"<how to fix>\"\n    }\n  ],\n  \"bestPractices\": [\n    {\n      \"title\": \"<best practice>\",\n      \"description\": \"<detailed description>\"\n    }\n  ]\n}`\n\n    console.log(\"[v0] Sending request to Groq API\")\n\n    const message = await groq.chat.completions.create({\n      model: \"llama-3.3-70b-versatile\", // Updated to currently supported model\n      max_tokens: 4000,\n      messages: [\n        {\n          role: \"user\",\n          content: prompt,\n        },\n      ],\n    })\n\n    console.log(\"[v0] Groq response received\")\n\n    const responseText = message.choices[0]?.message?.content || \"\"\n    if (!responseText) {\n      console.error(\"[v0] Empty response from Groq\")\n      return Response.json({ error: \"Empty response from AI\" }, { status: 500 })\n    }\n\n    // Parse JSON response from Groq\n    const jsonMatch = responseText.match(/\\{[\\s\\S]*\\}/)\n    if (!jsonMatch) {\n      console.error(\"[v0] Failed to extract JSON from response:\", responseText.substring(0, 200))\n      return Response.json({ error: \"Failed to parse analysis response\" }, { status: 500 })\n    }\n\n    const analysis = JSON.parse(jsonMatch[0])\n    console.log(\"[v0] Analysis parsed successfully\")\n\n    return Response.json(analysis)\n  } catch (error) {\n    console.error(\"[v0] Review API error:\", error.message)\n    return Response.json(\n      { error: error.message || \"Failed to analyze code\" },\n      { status: 500 }\n    )\n  }\n}"],"names":[],"mappings":"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"}}]
}